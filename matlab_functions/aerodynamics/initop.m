%% aerodynamics look-up
function [ReList,wingPolar,wingPolarp20,wingPolarm20,tailPolarp30,A0,A0_tail,s0, s0_tail,s0_LE,s0_TE,Iy_LE,Ix_LE,Iy_TE,Ix_TE]=init
ReList=[30000,60000,120000,240000,480000,960000,1920000,3840000];
% here's the polars
wingPolarp20=[0.000	1.073	0.072	-0.191];
wingPolarm20=[0.000	-0.794	0.045	0.064];
tailPolarp30=[0.000	1.163	0.058	-0.147];
wingPolar{1}=[...
-8.000	-0.304	0.113	-0.009
-7.500	-0.250	0.100	-0.010
-7.000	-0.230	0.094	-0.007
-6.500	-0.204	0.087	-0.004
-4.500	-0.404	0.069	-0.026
-4.000	-0.360	0.058	-0.039
-3.500	-0.300	0.049	-0.049
-3.000	-0.235	0.042	-0.054
-2.500	-0.176	0.038	-0.057
-2.000	-0.117	0.035	-0.058
-1.500	-0.065	0.032	-0.054
-1.000	-0.046	0.030	-0.046
-0.500	0.002	0.031	-0.048
0.000	0.047	0.033	-0.050
0.500	0.088	0.034	-0.051
1.000	0.128	0.036	-0.052
1.500	0.166	0.039	-0.053
2.000	0.202	0.041	-0.054
2.500	0.235	0.044	-0.055
3.000	0.267	0.047	-0.056
3.500	0.335	0.052	-0.064
4.000	0.417	0.057	-0.074
4.500	0.485	0.061	-0.081
5.000	0.543	0.066	-0.086
5.500	0.593	0.071	-0.089
6.000	0.634	0.075	-0.090
6.500	0.670	0.080	-0.091
7.000	0.698	0.085	-0.091
8.000	0.683	0.101	-0.094
8.500	0.652	0.108	-0.094
9.000	0.782	0.112	-0.094
9.500	0.704	0.122	-0.097
10.500	0.744	0.136	-0.099
11.500	0.798	0.154	-0.103
12.000	0.826	0.164	-0.105
12.500	0.835	0.171	-0.105
13.000	0.847	0.177	-0.105
13.500	0.862	0.184	-0.106
14.000	0.889	0.195	-0.108
14.500	0.878	0.195	-0.108
15.000	0.885	0.201	-0.110
15.500	0.908	0.211	-0.112
16.000	0.945	0.227	-0.114
];
wingPolar{2}=[...
-5.000	-0.445	0.079	-0.008
-4.500	-0.443	0.074	-0.005
-3.500	-0.277	0.041	-0.055
-3.000	-0.218	0.036	-0.057
-2.500	-0.164	0.032	-0.059
-2.000	-0.093	0.030	-0.063
-1.500	0.005	0.026	-0.070
-1.000	0.054	0.026	-0.066
-0.500	0.140	0.028	-0.074
0.000	0.221	0.029	-0.081
0.500	0.295	0.030	-0.086
1.000	0.364	0.031	-0.089
1.500	0.435	0.032	-0.093
2.000	0.509	0.033	-0.096
2.500	0.572	0.034	-0.097
3.000	0.642	0.035	-0.099
3.500	0.720	0.034	-0.101
4.000	0.784	0.034	-0.100
4.500	0.844	0.034	-0.099
5.000	0.888	0.035	-0.096
5.500	0.950	0.034	-0.094
6.000	1.015	0.033	-0.092
6.500	1.085	0.031	-0.091
7.000	1.149	0.031	-0.090
7.500	1.191	0.032	-0.086
8.000	1.251	0.032	-0.085
8.500	1.284	0.033	-0.081
9.000	1.330	0.034	-0.078
9.500	1.355	0.037	-0.074
10.000	1.391	0.039	-0.070
10.500	1.404	0.042	-0.065
11.000	1.416	0.045	-0.059
11.500	1.429	0.050	-0.054
12.000	1.442	0.054	-0.050
];
wingPolar{3}=[...
-7.000	-0.434	0.090	-0.028
-6.500	-0.413	0.077	-0.043
-6.000	-0.363	0.070	-0.049
-5.500	-0.313	0.058	-0.068
-5.000	-0.251	0.051	-0.079
-4.500	-0.166	0.032	-0.088
-3.500	-0.011	0.023	-0.097
-3.000	0.061	0.021	-0.100
-2.500	0.138	0.019	-0.104
-2.000	0.200	0.017	-0.106
-1.500	0.252	0.016	-0.102
-1.000	0.324	0.016	-0.103
-0.500	0.390	0.016	-0.106
0.000	0.454	0.016	-0.107
0.500	0.513	0.016	-0.107
1.000	0.575	0.016	-0.108
1.500	0.631	0.016	-0.107
2.000	0.686	0.016	-0.106
2.500	0.742	0.016	-0.105
3.000	0.798	0.016	-0.105
3.500	0.849	0.016	-0.103
4.000	0.901	0.016	-0.102
4.500	0.951	0.016	-0.100
5.000	1.002	0.017	-0.098
5.500	1.053	0.017	-0.097
6.000	1.101	0.017	-0.095
6.500	1.146	0.018	-0.092
7.000	1.189	0.019	-0.090
7.500	1.230	0.020	-0.087
8.000	1.269	0.021	-0.085
8.500	1.304	0.022	-0.082
9.000	1.336	0.024	-0.078
9.500	1.362	0.026	-0.074
10.000	1.380	0.027	-0.068
10.500	1.391	0.030	-0.062
11.000	1.399	0.033	-0.057
11.500	1.409	0.036	-0.052
12.000	1.421	0.040	-0.048
12.500	1.428	0.043	-0.045
13.000	1.444	0.048	-0.042
13.500	1.447	0.053	-0.039
14.000	1.448	0.058	-0.036
];
wingPolar{4}=[...
-7.500	-0.357	0.080	-0.043
-6.500	-0.147	0.021	-0.098
-5.500	-0.131	0.033	-0.109
-5.000	-0.067	0.020	-0.110
-4.500	-0.007	0.016	-0.111
-4.000	0.053	0.015	-0.112
-3.500	0.107	0.014	-0.111
-3.000	0.162	0.013	-0.111
-2.500	0.216	0.011	-0.112
-2.000	0.268	0.010	-0.111
-1.500	0.321	0.010	-0.110
-1.000	0.370	0.010	-0.107
-0.500	0.412	0.010	-0.103
0.000	0.485	0.009	-0.105
0.500	0.540	0.010	-0.105
1.000	0.596	0.010	-0.105
1.500	0.651	0.010	-0.105
2.000	0.705	0.010	-0.105
2.500	0.758	0.010	-0.104
3.000	0.811	0.010	-0.103
3.500	0.864	0.010	-0.102
4.000	0.916	0.011	-0.101
4.500	0.967	0.011	-0.100
5.000	1.016	0.011	-0.099
5.500	1.064	0.012	-0.097
6.000	1.109	0.013	-0.095
6.500	1.153	0.014	-0.093
7.000	1.195	0.015	-0.091
7.500	1.238	0.015	-0.089
8.000	1.278	0.016	-0.087
8.500	1.315	0.018	-0.084
9.000	1.350	0.019	-0.081
9.500	1.377	0.020	-0.077
10.000	1.402	0.022	-0.072
10.500	1.420	0.024	-0.068
11.000	1.434	0.026	-0.063
11.500	1.443	0.030	-0.058
12.000	1.453	0.033	-0.055
12.500	1.458	0.037	-0.051
13.000	1.469	0.041	-0.049
13.500	1.467	0.046	-0.046
14.000	1.4671	0.051	-0.043
14.500	1.470	0.056	-0.042
15.000	1.4701	0.062	-0.042
];
wingPolar{5}=[...
-8.500	-0.345	0.087	-0.042
-8.000	-0.335	0.077	-0.052
-6.500	-0.222	0.019	-0.109
-6.000	-0.165	0.017	-0.110
-5.500	-0.111	0.015	-0.110
-5.000	-0.058	0.013	-0.109
-4.500	-0.005	0.012	-0.109
-4.000	0.050	0.011	-0.108
-3.500	0.105	0.010	-0.108
-3.000	0.161	0.010	-0.108
-2.500	0.217	0.009	-0.108
-2.000	0.271	0.008	-0.109
-1.500	0.326	0.008	-0.108
-1.000	0.381	0.008	-0.108
-0.500	0.434	0.007	-0.107
0.000	0.486	0.007	-0.106
0.500	0.532	0.007	-0.103
1.000	0.597	0.007	-0.105
1.500	0.653	0.007	-0.105
2.000	0.709	0.007	-0.104
2.500	0.763	0.007	-0.104
3.000	0.817	0.008	-0.104
3.500	0.870	0.008	-0.103
4.000	0.922	0.008	-0.102
4.500	0.973	0.009	-0.102
5.000	1.023	0.009	-0.100
5.500	1.072	0.010	-0.099
6.000	1.118	0.011	-0.098
6.500	1.166	0.011	-0.097
7.000	1.212	0.012	-0.095
7.500	1.258	0.013	-0.094
8.000	1.302	0.014	-0.092
8.500	1.343	0.015	-0.090
9.000	1.382	0.016	-0.087
9.500	1.417	0.017	-0.084
10.000	1.444	0.018	-0.080
10.500	1.468	0.020	-0.075
11.000	1.489	0.022	-0.071
11.500	1.509	0.024	-0.067
12.000	1.524	0.027	-0.063
12.500	1.545	0.029	-0.060
13.000	1.549	0.033	-0.056
13.500	1.555	0.037	-0.053
14.000	1.568	0.041	-0.051
14.500	1.572	0.045	-0.050
];

wingPolar{6}=[...
-9.000	-0.520	0.025	-0.097
-8.500	-0.453	0.021	-0.102
-8.000	-0.381	0.019	-0.107
-7.500	-0.326	0.016	-0.109
-7.000	-0.278	0.013	-0.109
-6.500	-0.227	0.012	-0.108
-6.000	-0.174	0.011	-0.108
-5.500	-0.120	0.010	-0.107
-5.000	-0.065	0.010	-0.107
-4.500	-0.010	0.009	-0.107
-4.000	0.046	0.009	-0.107
-3.500	0.103	0.008	-0.107
-3.000	0.159	0.008	-0.107
-2.500	0.216	0.008	-0.107
-2.000	0.272	0.007	-0.108
-1.500	0.328	0.007	-0.108
-1.000	0.384	0.006	-0.108
-0.500	0.440	0.006	-0.108
0.000	0.497	0.006	-0.108
0.500	0.551	0.006	-0.108
1.000	0.605	0.006	-0.107
1.500	0.655	0.006	-0.105
2.000	0.714	0.006	-0.106
2.500	0.768	0.006	-0.105
3.000	0.823	0.006	-0.105
3.500	0.876	0.007	-0.105
4.000	0.929	0.007	-0.104
4.500	0.981	0.008	-0.103
5.000	1.031	0.008	-0.103
5.500	1.082	0.009	-0.102
6.000	1.132	0.009	-0.101
6.500	1.182	0.010	-0.100
7.000	1.231	0.010	-0.099
7.500	1.278	0.011	-0.098
8.000	1.324	0.012	-0.097
8.500	1.367	0.013	-0.095
9.000	1.409	0.014	-0.092
9.500	1.447	0.015	-0.090
10.000	1.483	0.016	-0.087
10.500	1.512	0.017	-0.083
11.000	1.544	0.018	-0.079
11.500	1.567	0.020	-0.075
12.000	1.595	0.021	-0.071
12.500	1.619	0.023	-0.068
13.000	1.632	0.026	-0.064
13.500	1.655	0.028	-0.061
14.000	1.674	0.030	-0.058
14.500	1.683	0.034	-0.056
];

wingPolar{7}=[...
-11.500	-0.816	0.021	-0.093
-11.000	-0.764	0.019	-0.095
-10.500	-0.706	0.017	-0.097
-10.000	-0.634	0.017	-0.101
-9.500	-0.552	0.016	-0.107
-9.000	-0.497	0.013	-0.109
-8.500	-0.446	0.012	-0.109
-8.000	-0.395	0.012	-0.108
-7.500	-0.343	0.011	-0.107
-7.000	-0.290	0.010	-0.107
-6.500	-0.235	0.010	-0.107
-6.000	-0.180	0.009	-0.107
-5.500	-0.124	0.008	-0.107
-5.000	-0.067	0.008	-0.107
-4.500	-0.011	0.008	-0.107
-4.000	0.046	0.007	-0.107
-3.500	0.103	0.007	-0.107
-3.000	0.161	0.007	-0.107
-2.500	0.219	0.007	-0.108
-2.000	0.276	0.006	-0.108
-1.500	0.333	0.006	-0.108
-0.500	0.446	0.005	-0.109
0.000	0.502	0.005	-0.109
0.500	0.559	0.005	-0.109
1.000	0.614	0.005	-0.109
1.500	0.669	0.005	-0.109
2.000	0.723	0.005	-0.108
2.500	0.776	0.005	-0.108
3.000	0.825	0.006	-0.106
3.500	0.882	0.006	-0.106
4.000	0.935	0.006	-0.106
4.500	0.988	0.007	-0.106
5.000	1.041	0.007	-0.105
5.500	1.092	0.008	-0.104
6.000	1.144	0.008	-0.104
6.500	1.195	0.009	-0.103
7.000	1.245	0.009	-0.102
7.500	1.294	0.010	-0.101
8.000	1.340	0.011	-0.100
8.500	1.385	0.012	-0.098
9.000	1.428	0.012	-0.096
9.500	1.471	0.013	-0.095
10.000	1.514	0.014	-0.093
10.500	1.552	0.015	-0.090
11.000	1.590	0.016	-0.087
11.500	1.619	0.017	-0.083
12.000	1.650	0.018	-0.079
12.500	1.679	0.019	-0.076
13.000	1.702	0.021	-0.072
13.500	1.725	0.022	-0.068
14.000	1.749	0.024	-0.065
14.500	1.767	0.027	-0.062
15.000	1.777	0.030	-0.059
15.500	1.792	0.033	-0.056
16.000	1.805	0.036	-0.054
16.500	1.812	0.040	-0.052
];

wingPolar{8}=[...
-11.500	-0.814	0.012	-0.101
-11.000	-0.729	0.012	-0.108
-10.500	-0.668	0.012	-0.109
-10.000	-0.616	0.011	-0.108
-9.500	-0.565	0.011	-0.107
-9.000	-0.511	0.011	-0.107
-8.500	-0.456	0.011	-0.107
-8.000	-0.401	0.011	-0.107
-7.000	-0.292	0.009	-0.107
-6.500	-0.236	0.008	-0.107
-6.000	-0.180	0.008	-0.107
-5.500	-0.123	0.007	-0.107
-5.000	-0.065	0.007	-0.107
-4.500	-0.008	0.007	-0.108
-4.000	0.050	0.006	-0.108
-3.500	0.108	0.006	-0.108
-3.000	0.165	0.006	-0.108
-2.500	0.223	0.006	-0.109
-2.000	0.280	0.006	-0.109
-1.500	0.337	0.005	-0.109
-1.000	0.394	0.005	-0.109
-0.500	0.450	0.005	-0.110
0.000	0.506	0.005	-0.110
0.500	0.562	0.005	-0.110
1.000	0.618	0.005	-0.110
1.500	0.674	0.005	-0.110
2.000	0.729	0.005	-0.110
2.500	0.783	0.005	-0.109
3.000	0.837	0.006	-0.109
3.500	0.891	0.006	-0.109
4.000	0.944	0.006	-0.108
4.500	0.995	0.006	-0.107
5.000	1.048	0.007	-0.107
5.500	1.101	0.007	-0.107
6.000	1.154	0.007	-0.106
6.500	1.205	0.008	-0.106
7.000	1.256	0.008	-0.105
7.500	1.305	0.009	-0.104
8.000	1.353	0.010	-0.103
8.500	1.400	0.010	-0.101
9.000	1.447	0.011	-0.100
9.500	1.492	0.012	-0.099
10.000	1.539	0.012	-0.097
10.500	1.581	0.013	-0.095
11.000	1.624	0.014	-0.093
11.500	1.664	0.015	-0.091
12.000	1.695	0.016	-0.087
12.500	1.729	0.016	-0.084
13.000	1.757	0.018	-0.080
13.500	1.781	0.019	-0.075
14.000	1.808	0.020	-0.072
14.500	1.831	0.022	-0.069
15.000	1.849	0.024	-0.065
15.500	1.864	0.027	-0.062
16.000	1.883	0.029	-0.059
16.500	1.897	0.032	-0.057
17.000	1.907	0.036	-0.055
17.500	1.910	0.040	-0.053
];

airfoil = [...
  0.99991827     0.00088256
  0.99239612     0.00372417
  0.98156535     0.00691616
  0.97059460     0.00959046
  0.95957466     0.01205572
  0.94853628     0.01443719
  0.93748854     0.01677492
  0.92643480     0.01908410
  0.91537940     0.02138534
  0.90432443     0.02368861
  0.89326857     0.02598764
  0.88220902     0.02826881
  0.87114419     0.03052428
  0.86007493     0.03275788
  0.84899982     0.03496231
  0.83791622     0.03712359
  0.82682490     0.03924495
  0.81572749     0.04133424
  0.80462328     0.04338702
  0.79351176     0.04539990
  0.78239401     0.04737813
  0.77127065     0.04932421
  0.76014125     0.05123683
  0.74900790     0.05312119
  0.73786937     0.05499303
  0.72674267     0.05687245
  0.72000000     0.05803274
  0.71558714     0.05879211
  0.70456078     0.06073576
  0.69020760     0.06329651
  0.66935928     0.06690547
  0.64355338     0.07108051
  0.61581231     0.07512173
  0.58740137     0.07880793
  0.55883764     0.08206024
  0.53006340     0.08488644
  0.50123643     0.08733758
  0.47245118     0.08934950
  0.44373367     0.09092234
  0.41502894     0.09203455
  0.38639368     0.09266886
  0.35782287     0.09282508
  0.32933849     0.09247330
  0.30100774     0.09159539
  0.27286158     0.09017246
  0.24498189     0.08816427
  0.21751153     0.08553008
  0.19058666     0.08221354
  0.16432978     0.07813746
  0.13888591     0.07322849
  0.11445833     0.06743957
  0.09138306     0.06078041
  0.07025512     0.05340018
  0.05195427     0.04570434
  0.03725333     0.03828816
  0.02615023     0.03156807
  0.01798908     0.02563645
  0.01200709     0.02038662
  0.00761477     0.01567061
  0.00441337     0.01137293
  0.00216352     0.00739939
  0.00072642     0.00369208
  0.00003409     0.00023073
  0.00008807    -0.00302417
  0.00115976    -0.00624116
  0.00350412    -0.00909020
  0.00694098    -0.01147141
  0.01137268    -0.01357069
  0.01700203    -0.01550975
  0.02430623    -0.01735812
  0.03413767    -0.01918157
  0.04783529    -0.02102630
  0.06673654    -0.02281758
  0.09059551    -0.02430222
  0.11758053    -0.02529532
  0.14610326    -0.02584887
  0.17532475    -0.02606096
  0.20488466    -0.02600007
  0.23461316    -0.02570678
  0.26440235    -0.02520738
  0.29421282    -0.02451659
  0.32400889    -0.02362421
  0.35372912    -0.02252543
  0.38349605    -0.02119682
  0.41349344    -0.01965946
  0.44369834    -0.01801663
  0.47405359    -0.01630271
  0.50438236    -0.01455974
  0.53464892    -0.01282857
  0.56472804    -0.01108889
  0.59461297    -0.00950939
  0.62429556    -0.00807239
  0.65295448    -0.00687224
  0.67823259    -0.00592599
  0.69714806    -0.00528184
  0.70967055    -0.00483484
  0.72078924    -0.00438006
  0.73211349    -0.00384362
  0.74337826    -0.00324842
  0.75465675    -0.00262843
  0.76593234    -0.00202853
  0.77721124    -0.00147271
  0.78849189    -0.00095981
  0.79977435    -0.00048663
  0.81105891    -0.00006692
  0.82234582     0.00028408
  0.83363455     0.00057068
  0.84492451     0.00080378
  0.85621549     0.00097996
  0.86750726     0.00109615
  0.87879940     0.00116768
  0.89009170     0.00120539
  0.90138406     0.00119857
  0.91267626     0.00113855
  0.92396805     0.00102504
  0.93525910     0.00085362
  0.94654906     0.00062090
  0.95783739     0.00031949
  0.96912357    -0.00005384
  0.98040833    -0.00046804
  0.99169424    -0.00087171
  0.99974397    -0.00111748    
  0.99991827     0.00088256
];

LE_start=52;
LE_end=74;
leadingEdge=[airfoil(LE_start:LE_end,:);airfoil(LE_start,:)];
leadingEdge(LE_end-LE_start+1,:)=airfoil(LE_end-1,:)...
    +(airfoil(LE_end,:)-airfoil(LE_end-1,:))...
    *(1-(airfoil(LE_end,1)-(airfoil(LE_start,1)))/(airfoil(LE_end,1)-airfoil(LE_end-1,1)));

TE_start=110;
TE_end=13;
trailingEdge =[airfoil(TE_start:length(airfoil),:);...
    airfoil(1:TE_end,:);airfoil(TE_start,:)];
trailingEdge(length(trailingEdge)-1,:)=airfoil(TE_end-1,:)...
    +(airfoil(TE_end,:)-airfoil(TE_end-1,:))...
    *(1-(airfoil(TE_end,1)-(airfoil(TE_start,1)))/(airfoil(TE_end,1)-airfoil(TE_end-1,1)));

% plot(airfoil(:,1),airfoil(:,2)), axis equal; hold on;
% plot(leadingEdge(:,1),leadingEdge(:,2),'r'), axis equal; hold on;
% plot(trailingEdge(:,1),trailingEdge(:,2),'r'), axis equal; hold on;

airfoil_tail = [...
1.000000    0.000000
     0.993212    0.000476
     0.980807    0.001348
     0.965749    0.002337
     0.948812    0.003479
     0.930913    0.004785
     0.912504    0.006222
     0.893820    0.007746
     0.875003    0.009326
     0.856178    0.010927
     0.837509    0.012496
     0.819120    0.014128
     0.800992    0.015826
     0.783625    0.017594
     0.766711    0.019735
     0.749257    0.022299
     0.731221    0.024933
     0.712835    0.027591
     0.694255    0.030335
     0.675672    0.033052
     0.657193    0.035681
     0.638771    0.038195
     0.620392    0.040628
     0.602311    0.042909
     0.584260    0.044957
     0.565823    0.046905
     0.547272    0.048861
     0.528965    0.050725
     0.510843    0.052400
     0.492706    0.053913
     0.474615    0.055284
     0.456618    0.056473
     0.438609    0.057476
     0.420554    0.058307
     0.402436    0.058980
     0.384358    0.059512
     0.366410    0.059855
     0.348413    0.059991
     0.330339    0.059971
     0.312327    0.059791
     0.294354    0.059416
     0.276311    0.058860
     0.258325    0.058164
     0.240500    0.057269
     0.222614    0.056161
     0.204830    0.054912
     0.187271    0.053446
     0.169754    0.051745
     0.152439    0.049871
     0.135466    0.047743
     0.118700    0.045376
     0.102621    0.042846
     0.087235    0.040012
     0.072890    0.037108
     0.060163    0.034152
     0.049137    0.031235
     0.039944    0.028518
     0.032385    0.025938
     0.026136    0.023572
     0.020972    0.021409
     0.016688    0.019303
     0.013074    0.017239
     0.009974    0.015271
     0.007314    0.013377
     0.005083    0.011465
     0.003287    0.009468
     0.001918    0.007384
     0.000944    0.005252
     0.000328    0.003119
     0.000035    0.001021
     0.000035   -0.001021
     0.000328   -0.003118
     0.000944   -0.005252
     0.001918   -0.007384
     0.003287   -0.009468
     0.005083   -0.011465
     0.007314   -0.013377
     0.009974   -0.015271
     0.013074   -0.017238
     0.016688   -0.019303
     0.020973   -0.021408
     0.026136   -0.023572
     0.032386   -0.025938
     0.039945   -0.028518
     0.049138   -0.031234
     0.060164   -0.034151
     0.072892   -0.037108
     0.087237   -0.040012
     0.102623   -0.042845
     0.118702   -0.045376
     0.135468   -0.047742
     0.152441   -0.049870
     0.169756   -0.051744
     0.187274   -0.053445
     0.204832   -0.054912
     0.222617   -0.056161
     0.240502   -0.057269
     0.258328   -0.058164
     0.276313   -0.058860
     0.294356   -0.059416
     0.312330   -0.059791
     0.330341   -0.059971
     0.348415   -0.059991
     0.366412   -0.059855
     0.384360   -0.059512
     0.402438   -0.058980
     0.420555   -0.058307
     0.438611   -0.057476
     0.456619   -0.056473
     0.474616   -0.055284
     0.492707   -0.053913
     0.510845   -0.052401
     0.528966   -0.050725
     0.547273   -0.048861
     0.565824   -0.046905
     0.584261   -0.044957
     0.602312   -0.042909
     0.620393   -0.040628
     0.638772   -0.038194
     0.657195   -0.035681
     0.675674   -0.033051
     0.694256   -0.030335
     0.712837   -0.027590
     0.731224   -0.024933
     0.749260   -0.022298
     0.766713   -0.019735
     0.783626   -0.017594
     0.800992   -0.015825
     0.819121   -0.014128
     0.837510   -0.012495
     0.856179   -0.010927
     0.875004   -0.009326
     0.893821   -0.007745
     0.912505   -0.006222
     0.930914   -0.004785
     0.948813   -0.003479
     0.965749   -0.002337
     0.980807   -0.001348
     0.993212   -0.000477
     1.000000    0.000000
];

%% get some geometrical properties
% airfoil area
A0=0;
% airfoil circumference
s0=0;
% centroid
c0=[0,0];
for i=1:size(airfoil,1)-1
    A0=A0+(airfoil(i,1)*airfoil(i+1,2)-airfoil(i+1,1)*airfoil(i,2));
    d=sqrt((airfoil(i+1,:)-airfoil(i,:))*(airfoil(i+1,:)-airfoil(i,:))');
    s0=s0+d;
    c0=c0+d*(airfoil(i+1,:)+airfoil(i,:))/2;
end

A0_tail=0;
s0_tail=0;
for i=1:size(airfoil_tail,1)-1
    A0_tail=A0_tail+(airfoil_tail(i,1)*airfoil_tail(i+1,2)-airfoil_tail(i+1,1)*airfoil_tail(i,2));
    d=sqrt((airfoil_tail(i+1,:)-airfoil_tail(i,:))*(airfoil_tail(i+1,:)-airfoil_tail(i,:))');
    s0_tail=s0_tail+d;
end

% % second order moment devided by thickness
% Ix=0; Iy=0;
% for i=1:size(airfoil,1)-1
%     d=sqrt((airfoil(i+1,:)-airfoil(i,:))*(airfoil(i+1,:)-airfoil(i,:))');
%     P=(airfoil(i+1,:)+airfoil(i,:))/2;
%     rd=(P-c0);
%     Ix=Ix+rd(1)^2*d;
%     Iy=Iy+rd(2)^2*d;
% end

% calculate the front section
c0_LE=[0,0];
A0_LE=0;
s0_LE=0;
for i=1:size(leadingEdge,1)-1
    A0_LE=A0_LE+(leadingEdge(i,1)*leadingEdge(i+1,2)-leadingEdge(i+1,1)*leadingEdge(i,2));
    d=sqrt((leadingEdge(i+1,:)-leadingEdge(i,:))*(leadingEdge(i+1,:)-leadingEdge(i,:))');
    s0_LE=s0_LE+d;
    c0_LE=c0_LE+d*(leadingEdge(i+1,:)+leadingEdge(i,:))/2;
end
Ix_LE=0; %area second moment of inertia divided by shell thickness
Iy_LE=0; %area second moment of inertia divided by shell thickness
for i=1:size(leadingEdge,1)-1
    d=sqrt((leadingEdge(i+1,:)-leadingEdge(i,:))*(leadingEdge(i+1,:)-leadingEdge(i,:))');
    x=c0_LE(1)-leadingEdge(i,1);
    y=c0_LE(2)-leadingEdge(i,2);
    Iy_LE=Iy_LE+x^2*d;
    Ix_LE=Ix_LE+y^2*d;
end

% calculate the trailing section
c0_TE=[0,0];
A0_TE=0;
s0_TE=0;
for i=1:size(trailingEdge,1)-1
    A0_TE=A0_TE+(trailingEdge(i,1)*trailingEdge(i+1,2)-trailingEdge(i+1,1)*trailingEdge(i,2));
    d=sqrt((trailingEdge(i+1,:)-trailingEdge(i,:))*(trailingEdge(i+1,:)-trailingEdge(i,:))');
    s0_TE=s0_TE+d;
    c0_TE=c0_TE+d*(trailingEdge(i+1,:)+trailingEdge(i,:))/2;
end
Ix_TE=0; %area second moment of inertia divided by shell thickness
Iy_TE=0; %area second moment of inertia divided by shell thickness
for i=1:size(trailingEdge,1)-1
    d=sqrt((trailingEdge(i+1,:)-trailingEdge(i,:))*(trailingEdge(i+1,:)-trailingEdge(i,:))');
    x=c0_TE(1)-trailingEdge(i,1);
    y=c0_TE(2)-trailingEdge(i,2);
    Iy_TE=Iy_TE+x^2*d;
    Ix_TE=Ix_TE+y^2*d;
end

%% calculation of deflected control surface airfoils
% r_ctr = 0.3;
% a_main = 20/180*pi;
% a_tail = 30/180*pi;
% ctr=[1-r_ctr; 0]; %center of rotation
% airfoil_p=[];
% for i=1:size(airfoil,1)-1
%     if (airfoil(i,1)>=1-r_ctr)
%         p_new=[cos(a_main) sin(a_main); -sin(a_main) cos(a_main)]...
%             *(airfoil(i,:)'-ctr)+ctr;
%         if (p_new(1)>=1-r_ctr)
%             airfoil_p=[airfoil_p; p_new'];
%         end
%     else
%         airfoil_p=[airfoil_p; airfoil(i,:)];
%     end
% end
% airfoil_m=[];
% for i=1:size(airfoil,1)-1
%     if (airfoil(i,1)>=1-r_ctr)
%         p_new=[cos(-a_main) sin(-a_main); -sin(-a_main) cos(-a_main)]...
%             *(airfoil(i,:)'-ctr)+ctr;
%         if (p_new(1)>=1-r_ctr)
%             airfoil_m=[airfoil_m; p_new'];
%         end
%     else
%         airfoil_m=[airfoil_m; airfoil(i,:)];
%     end
% end
% airfoil_tail_p=[];
% for i=1:size(airfoil_tail,1)
%     if (airfoil_tail(i,1)>=1-r_ctr)
%         p_new=[cos(a_tail) sin(a_tail); -sin(a_tail) cos(a_tail)]...
%             *(airfoil_tail(i,:)'-ctr)+ctr;
%         if (p_new(1)>=1-r_ctr)
%             airfoil_tail_p=[airfoil_tail_p; p_new'];
%         end
%     else
%         airfoil_tail_p=[airfoil_tail_p; airfoil_tail(i,:)];
%     end
% end
% airfoil_tail_m=[];
% for i=1:size(airfoil_tail,1)
%     if (airfoil_tail(i,1)>=1-r_ctr)
%         p_new=[cos(-a_tail) sin(-a_tail); -sin(-a_tail) cos(-a_tail)]...
%             *(airfoil_tail(i,:)'-ctr)+ctr;
%         if (p_new(1)>=1-r_ctr)
%             airfoil_tail_m=[airfoil_tail_m; p_new'];
%         end
%     else
%         airfoil_tail_m=[airfoil_tail_m; airfoil_tail(i,:)];
%     end
% end